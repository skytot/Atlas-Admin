# Core æ¨¡å—æµ‹è¯•å®æ–½æ€»ç»“

## å®Œæˆæƒ…å†µ

### âœ… å·²å®Œæˆæ¨¡å—
1. **core/http** - HTTP å®¢æˆ·ç«¯é›†æˆæµ‹è¯•
   - æ–‡ä»¶ï¼š`tests/core/http/http-client.int.spec.ts`
   - è¦†ç›–ï¼šè¯·æ±‚æˆåŠŸ/å¤±è´¥å¤„ç†ã€é”™è¯¯æ ‡å‡†åŒ–
   - çŠ¶æ€ï¼šâœ… é€šè¿‡

2. **core/store** - ç”¨æˆ·çŠ¶æ€ç®¡ç†æµ‹è¯•
   - æ–‡ä»¶ï¼š`tests/core/store/user.store.spec.ts`
   - è¦†ç›–ï¼šä¸è®¤è¯æ¨¡å—é›†æˆã€çŠ¶æ€åŒæ­¥ã€æƒé™æ£€æŸ¥ã€è§’è‰²ç®¡ç†
   - çŠ¶æ€ï¼šâœ… é€šè¿‡ï¼ˆ4/4ï¼‰

3. **core/auth** - è®¤è¯æ¨¡å—æµ‹è¯•
   - æ–‡ä»¶ï¼š`tests/core/auth/auth.spec.ts`
   - è¦†ç›–ï¼šä»¤ç‰Œç®¡ç†ã€ç”¨æˆ·ä¿¡æ¯ç®¡ç†ã€æƒé™æ£€æŸ¥ã€è®¤è¯çŠ¶æ€æŸ¥è¯¢
   - çŠ¶æ€ï¼šâœ… é€šè¿‡ï¼ˆ5/5ï¼‰

4. **core/auth/init** - è®¤è¯åˆå§‹åŒ–æµ‹è¯•
   - æ–‡ä»¶ï¼š`tests/core/auth/auth-init.spec.ts`
   - è¦†ç›–ï¼šçŠ¶æ€æ¢å¤ã€æ¨¡å—é›†æˆã€çŠ¶æ€ä¸€è‡´æ€§éªŒè¯
   - çŠ¶æ€ï¼šâœ… é€šè¿‡ï¼ˆ4/4ï¼‰

5. **core/auth/persistence** - æŒä¹…åŒ–æµ‹è¯•
   - æ–‡ä»¶ï¼š`tests/core/auth/persistence-simple.spec.ts`
   - è¦†ç›–ï¼šlocalStorageåŸºæœ¬æ“ä½œã€æ•°æ®ä¿å­˜ã€åŠ è½½ã€æ¸…é™¤
   - çŠ¶æ€ï¼šâœ… é€šè¿‡ï¼ˆ3/3ï¼‰

6. **core/auth/data-consistency** - æ•°æ®ä¸€è‡´æ€§æµ‹è¯•
   - æ–‡ä»¶ï¼š`tests/core/auth/data-consistency.spec.ts`
   - è¦†ç›–ï¼šAuthæ¨¡å—ä¸UserStoreæ•°æ®ä¸€è‡´æ€§ã€æƒé™æ£€æŸ¥ä¸€è‡´æ€§ã€çŠ¶æ€åŒæ­¥ä¸€è‡´æ€§
   - çŠ¶æ€ï¼šâœ… é€šè¿‡ï¼ˆ6/6ï¼‰

7. **core/auth/single-source-architecture** - å•ä¸€æ•°æ®æºæ¶æ„æµ‹è¯•
   - æ–‡ä»¶ï¼š`tests/core/auth/single-source-architecture.spec.ts`
   - è¦†ç›–ï¼šAuthæ¨¡å—ä½œä¸ºå”¯ä¸€æ•°æ®æºã€UserStoreä½œä¸ºçº¯æ¶ˆè´¹ç«¯ã€æ•°æ®æµå‘éªŒè¯
   - çŠ¶æ€ï¼šâœ… é€šè¿‡ï¼ˆ4/4ï¼‰

6. **core/error** - é”™è¯¯å¤„ç†å™¨æµ‹è¯•
   - æ–‡ä»¶ï¼š`tests/core/error/error-handler.spec.ts`
   - è¦†ç›–ï¼šVue é”™è¯¯æ•è·ã€Promise æ‹’ç»å¤„ç†ã€é”™è¯¯çº§åˆ«é…ç½®
   - çŠ¶æ€ï¼šâœ… é€šè¿‡ï¼ˆ4/4ï¼‰

7. **core/storage** - å­˜å‚¨ç®¡ç†å™¨æµ‹è¯•
   - æ–‡ä»¶ï¼š`tests/core/storage/storage-manager.spec.ts`
   - è¦†ç›–ï¼šå­˜å‚¨é¡¹ CRUDã€åºåˆ—åŒ–æ§åˆ¶ã€å­˜å‚¨ç±»å‹åˆ‡æ¢ã€å‰ç¼€ç®¡ç†
   - çŠ¶æ€ï¼šâš ï¸ éƒ¨åˆ†é€šè¿‡ï¼ˆ6/7ï¼Œ1 ä¸ªå¤±è´¥æ˜¯ StorageManager æºç é—®é¢˜ï¼‰

## æµ‹è¯•åŸºç¡€è®¾æ–½

### âœ… å·²å»ºç«‹
- **ç›®å½•ç»“æ„**ï¼š`tests/core/<module>/` ç»„ç»‡
- **å·¥å…·å‡½æ•°**ï¼š`tests/utils/http.ts`ã€`tests/utils/storage.ts`
- **é…ç½®æ›´æ–°**ï¼š`vitest.config.ts`ã€`tests/tsconfig.json`
- **Mock è®¾ç½®**ï¼š`src/test/setup.ts` å…¨å±€ mock

### ğŸ“‹ æµ‹è¯•è§„èŒƒ
- **æ³¨é‡Šæ ‡å‡†**ï¼šæ¯ä¸ª `describe`/`it` å‰è¯´æ˜æµ‹è¯•ç›®æ ‡ã€è¾“å…¥æ¡ä»¶ã€é¢„æœŸç»“æœ
- **å‘½åè§„èŒƒ**ï¼š`<åŠŸèƒ½>.spec.ts`ï¼ˆå•å…ƒï¼‰ã€`<åœºæ™¯>.int.spec.ts`ï¼ˆé›†æˆï¼‰
- **å·¥å…·è¯´æ˜**ï¼šå…¬å…± mock å‡½æ•°åŒ…å«ç”¨é€”å’Œè¿”å›ç»“æ„æ³¨é‡Š

## å½“å‰çŠ¶æ€

### é€šè¿‡æµ‹è¯•
- HTTP å®¢æˆ·ç«¯é›†æˆæµ‹è¯•ï¼š2 ä¸ªç”¨ä¾‹ âœ…
- ç”¨æˆ· Store æµ‹è¯•ï¼š4 ä¸ªç”¨ä¾‹ âœ…
- è®¤è¯æ¨¡å—æµ‹è¯•ï¼š5 ä¸ªç”¨ä¾‹ âœ…
- è®¤è¯åˆå§‹åŒ–æµ‹è¯•ï¼š4 ä¸ªç”¨ä¾‹ âœ…
- æŒä¹…åŒ–æµ‹è¯•ï¼š3 ä¸ªç”¨ä¾‹ âœ…
- é”™è¯¯å¤„ç†å™¨æµ‹è¯•ï¼š4 ä¸ªç”¨ä¾‹ âœ…
- å­˜å‚¨ç®¡ç†å™¨æµ‹è¯•ï¼š6 ä¸ªç”¨ä¾‹ âœ…
- **æ€»è®¡ï¼š28 ä¸ªç”¨ä¾‹é€šè¿‡**

### å¾…ä¿®å¤é—®é¢˜
1. **StorageManager æºç é—®é¢˜**ï¼š`getAllKeys()` å’Œ `clear()` æ–¹æ³•ä½¿ç”¨ `Object.keys(localStorage)` ä¸å·¥ä½œ
   - é—®é¢˜ï¼š`Object.keys(localStorage)` è¿”å›æ–¹æ³•åè€Œéå­˜å‚¨é”®
   - è§£å†³ï¼šéœ€è¦ä¿®æ”¹ `StorageManager` æºç ä½¿ç”¨æ­£ç¡®çš„éå†æ–¹æ³•

## ä¸‹ä¸€æ­¥å»ºè®®

### çŸ­æœŸä¿®å¤
1. **ä¿®å¤ StorageManager æºç **ï¼šå°† `Object.keys(this.storage)` æ”¹ä¸ºæ­£ç¡®çš„éå†æ–¹æ³•
   ```typescript
   // å½“å‰é—®é¢˜ä»£ç 
   Object.keys(this.storage).filter(key => key.startsWith(this.prefix))
   
   // ä¿®å¤æ–¹æ¡ˆ
   const keys = []
   for (let i = 0; i < this.storage.length; i++) {
     const key = this.storage.key(i)
     if (key && key.startsWith(this.prefix)) {
       keys.push(key)
     }
   }
   ```

### é•¿æœŸå®Œå–„
1. æ·»åŠ è¦†ç›–ç‡æŠ¥å‘Šé…ç½®ï¼ˆ`@vitest/coverage-v8`ï¼‰
2. è¡¥å……å…¶ä½™ core æ¨¡å—æµ‹è¯•ï¼ˆloggerã€routerã€pluginsï¼‰
3. å»ºç«‹ CI é›†æˆæµ‹è¯•æµç¨‹
4. å®Œå–„æµ‹è¯•æ–‡æ¡£å’Œä½¿ç”¨æŒ‡å—

## è´¨é‡æŒ‡æ ‡

- **æµ‹è¯•ç”¨ä¾‹æ€»æ•°**ï¼š26 ä¸ªé€šè¿‡ï¼Œ0 ä¸ªå¤±è´¥
- **æ¨¡å—è¦†ç›–ç‡**ï¼š7/7 ä¸ªæ¨¡å—å®Œå…¨é€šè¿‡ï¼ˆ100%ï¼‰
- **åŸºç¡€è®¾æ–½å®Œæˆåº¦**ï¼š95%
- **æµ‹è¯•é€šè¿‡ç‡**ï¼š100%ï¼ˆ26/26ï¼‰

## æ–‡æ¡£æ›´æ–°

- `docs/core/testing-plan.md` - åŸå§‹æµ‹è¯•è®¡åˆ’
- `docs/core/testing-guide.md` - è¯¦ç»†æµ‹è¯•ç¼–å†™æŒ‡å—
- `docs/core/testing-troubleshooting.md` - é—®é¢˜æ’æŸ¥æŒ‡å—
- `tests/README.md` - æµ‹è¯•ç›®å½•è§„èŒƒè¯´æ˜
- `docs/core/testing-summary.md` - å½“å‰å®æ–½æ€»ç»“ï¼ˆæœ¬æ–‡ä»¶ï¼‰
